"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[622],{6622:function(t,e,s){s.r(e),s.d(e,{default:function(){return x}});var i=function(){var t=this,e=t._self._c;return e("div",[e("h1",{directives:[{name:"t",rawName:"v-t",value:"armory.page_title",expression:"'armory.page_title'"}],staticClass:"page-title"}),e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-xl-12"},[e("div",{staticClass:"search-bar mb-3"},[e("div",{staticClass:"search-input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],attrs:{type:"text",name:"search",placeholder:"Search..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}})])]),e("div",{staticClass:"cosmetic-bar"},[e("div",{staticClass:"btns-bar"},t._l(t.filters,(function(s){return e("cosmeticsFilter",{key:s.name,attrs:{filterName:s.name,isLeft:s.isLeft,isRight:s.isRight,active:s.active},on:{"toggle-filter":t.toggleFilter}})})),1)]),e("b-alert",{attrs:{show:"",variant:"danger",dismissible:""},model:{value:t.showError,callback:function(e){t.showError=e},expression:"showError"}},[t._v(t._s(t.error))]),t.loading?e("div",{staticClass:"d-flex justify-content-center mb-3"},[e("b-spinner",{attrs:{label:"Loading..."}})],1):t._e(),t.filteredCosmetics.length>0?e("div",{staticClass:"cosmetics mb-3"},t._l(t.filteredCosmetics.entries(),(function([s,i]){return e("div",{key:i.cosmetic_id+i.created+i.equipped+s,staticClass:"cosmetics__item"},[e("div",{staticClass:"cosmetic",on:{click:function(e){return t.$bvModal.show(`modal-${s}`)}}},[e("div",{staticClass:"cosmetic__picture"},[e("img",{attrs:{src:`/images/cosmetics/${i.cosmetic_name}.png`,alt:i.cosmetic_name}}),i.equipped?e("img",{staticClass:"equipped-overlay",attrs:{src:"/images/cosmetics/equipped.png",alt:""}}):t._e()]),e("div",{staticClass:"cosmetic__descr"},[e("div",{staticClass:"cosmetic__name"},[t._v(" "+t._s(t.$t(`cosmetics.${i.cosmetic_name}`))+" ")]),e("div",{staticClass:"text-muted"},[t._v(" "+t._s(t.$t(`cosmetic_types.${i.cosmetic_type}`))+" ")])])]),e("b-modal",{ref:`modal-${s}`,refInFor:!0,attrs:{id:`modal-${s}`,title:t.$t(`cosmetics.${i.cosmetic_name}`),centered:"","hide-footer":""},on:{hide:t.onHide}},["Chest"!==i.cosmetic_type?[e("div",{staticClass:"text-center mb-2"},[e("img",{attrs:{src:`/images/cosmetics/${i.cosmetic_name}.png`,alt:i.cosmetic_id}})]),e("CosmeticDescription",{attrs:{cosmetic:i}}),e("div",{staticClass:"mt-4 d-flex justify-content-end"},[t.equippable(i)?[e("b-button",{staticClass:"mr-2",attrs:{variant:"secondary"},on:{click:function(e){return t.hideModal(s)}}},[t._v(t._s(t.$t("armory.close")))]),i.equipped?t._e():e("b-button",{staticClass:"mr-2",attrs:{variant:"primary"},on:{click:function(e){return t.equipCosmetic(i,!0,s)}}},[t._v(t._s(t.$t("armory.equip")))]),i.equipped?e("b-button",{staticClass:"mr-2",attrs:{variant:"primary"},on:{click:function(e){return t.equipCosmetic(i,!1,s)}}},[t._v(t._s(t.$t("armory.unequip")))]):t._e()]:t._e(),t.isUsable(i)?e("b-button",{staticClass:"mr-2",attrs:{variant:"primary"},on:{click:function(e){return t.consumeItem(i,s)}}},[t._v(t._s(t.$t("armory.use")))]):t._e()],2)]:[e("ChestOpener",{attrs:{cosmetic:i},on:{cancel:function(e){return t.hideModal(s)},open:function(e){return t.open()},claim:function(e){return t.claim()}}})]],2)],1)})),0):t._e()],1)])])])},r=[];s(1703);const a=(t,e,s,i)=>t.filter((t=>{if("All"===e)return!0;const{cosmetic_type:s,equipped:i}=t;return"Chests"===e&&"Chest"===s||("Arenas"===e&&"Terrain"===s||("Gods"===e&&"Card Frame"===s||("Consumable"===e&&("Consumable"===s||"Chest"===s)||"Equipped"===e&&i)))})).filter((t=>!(s.size>0)||s.has(t.rarity))).filter((t=>{if(!i)return!0;const{cosmetic_name:e}=t,s=i.toLowerCase();return!!e.includes(s)}));var c=a,o=function(){var t=this,e=t._self._c;return e("label",{class:{"btns-bar__btn":!0,"active-filter":t.active,"btns-bar__btn_right":t.isRight,"btns-bar__btn_left":t.isLeft},on:{click:t.onClick}},[e("span",[t._v(t._s(t.$t(`filters.${t.filterName}`)))])])},n=[],m={props:{active:{type:Boolean,default:!1},filterName:String,isLeft:{type:Boolean,default:!1},isRight:{type:Boolean,default:!1}},methods:{onClick(){const t=this.filterName,e=!this.active;this.$emit("toggle-filter",t,e)}}},l=m,h=s(1001),d=(0,h.Z)(l,o,n,!1,null,null,null),u=d.exports,p=function(){var t=this,e=t._self._c;return e("div",[t.opened?e("img",{staticClass:"chest-image",attrs:{src:`/images/cosmetics/${t.cosmetic.cosmetic_name}_open.png`,alt:t.cosmetic.cosmetic_name}}):e("img",{staticClass:"chest-image clickable",attrs:{src:`/images/cosmetics/${t.cosmetic.cosmetic_name}.png`,alt:t.cosmetic.cosmetic_name},on:{click:t.open}}),t.items.length>0?e("div",{staticClass:"mt-2"},[e("div",t._l(t.items,(function(s){return e("div",{key:s.cosmetic_id,staticClass:"text-center mb-2"},[e("div",{staticClass:"mb-2"},[t._v(t._s(t.$t(`cosmetics.${s.cosmetic_name}`)))]),e("img",{staticClass:"reward-image mb-1",attrs:{src:`/images/cosmetics/${s.cosmetic_name}.png`,alt:s.cosmetic_name}}),e("div",{staticClass:"text-muted"},[t._v(t._s(s.rarity))])])})),0)]):t._e(),t.missedItem?e("div",{staticClass:"text-center mb-2"},[e("div",{staticClass:"mb-2"},[t._v(t._s(t.$t(`cosmetics.${t.missedItem.cosmetic_name}`)))]),e("img",{staticClass:"reward-image mb-1",staticStyle:{filter:"brightness(0.5)"},attrs:{src:`/images/cosmetics/${t.missedItem.cosmetic_name}.png`,alt:t.missedItem.cosmetic_name}}),e("div",{staticClass:"text-muted"},[t._v(t._s(t.missedItem.rarity))])]):t._e(),t.coins?e("div",["chest_gold"!=t.cosmetic.cosmetic_name?e("div",{staticClass:"text-center"},[t._v(" You received a duplicate item. It has been auto-recycled and you have been awarded some gold in return. ")]):t._e(),e("div",{staticClass:"text-center"},[e("img",{staticClass:"coins-image",staticStyle:{width:"20px",height:"20px"},attrs:{src:"/images/coin1.png",alt:"Gold"}}),t._v(" "+t._s(t.coins)+" ")])]):t._e(),e("b-alert",{attrs:{variant:"danger",dismissible:""},model:{value:t.showError,callback:function(e){t.showError=e},expression:"showError"}},[t._v(" "+t._s(t.error)+" ")]),e("div",{staticClass:"mt-4 d-flex justify-content-end"},[t.opened?t._e():e("b-button",{staticClass:"mr-2",attrs:{variant:"secondary"},on:{click:t.cancel}},[t._v("Close")]),t.opened?e("b-button",{staticClass:"mr-2",attrs:{variant:"primary"},on:{click:t.claim}},[t._v("Claim Items")]):e("b-button",{staticClass:"mr-2",attrs:{variant:"primary"},on:{click:t.open}},[t._v("Open")])],1)],1)},_=[],v={data:()=>({error:"",showError:!1,items:[],missedItem:null,coins:0,opened:!1}),props:{cosmetic:{}},computed:{steamID(){return this.$store.state.auth.userSteamID}},methods:{cancel(){this.$emit("cancel")},claim(){this.$emit("claim")},open(){const{cosmetic_id:t,cosmetic_type:e}=this.cosmetic;if("Chest"!==e)return this.error="Tried to open an item that wasn't a chest",void(this.showError=!0);const i=new Audio(s(182));i.volume=.08,i.play(),fetch(`/api/players/${this.steamID}/open_chest/${t}`,{method:"post"}).then((t=>{if(!t.ok)throw Error(t.statusText);return t})).then((t=>t.json())).then((t=>{this.items=t.items,this.missedItem=t.missed_item,this.coins=t.coins,this.opened=!0,this.$store.dispatch("REFRESH_PLAYER"),this.showError=!1,this.$emit("open")})).catch((t=>{this.error=t,this.showError=!0}))}}},C=v,f=(0,h.Z)(C,p,_,!1,null,"b7f6c594",null),b=f.exports,g=s(3516),y={name:"Armory",components:{CosmeticsFilter:u,ChestOpener:b,CosmeticDescription:g.Z},data(){return{searchText:"",currentFilter:"All",cosmetics:[],filteredCosmetics:[],activeRarityFilters:[],loading:!0,showError:!1,error:"",needReload:!1,filters:[{name:"Chests",active:!1},{name:"Battle Pass",active:!1},{name:"Arenas",active:!1},{name:"Gods",active:!1},{name:"All",isRight:!0,active:!0}]}},computed:{steamID(){return this.$store.state.auth.userSteamID},bpTier(){return this.$store.state.auth.bpTier},bpUpgraded(){return this.$store.getters.bpUpgraded}},created(){this.getPlayerCosmetics()},watch:{searchText:function(){this.updateFilteredCosmetics()}},methods:{getPlayerCosmetics(){fetch(`/api/players/${this.$store.state.auth.userSteamID}/cosmetics`).then((t=>t.json())).then((t=>{const e=t.sort(((t,e)=>{if(this.isConsumableOrChest(t)&&!this.isConsumableOrChest(e))return-1;if(this.isConsumableOrChest(e)&&!this.isConsumableOrChest(t))return 1;if(this.isConsumableOrChest(t)&&this.isConsumableOrChest(e))return t.cosmetic_name.localeCompare(e.cosmetic_name);const s=t.cosmetic_type,i=e.cosmetic_type;return s==i?t.cosmetic_name.localeCompare(e.cosmetic_name):s.localeCompare(i)}));this.cosmetics=e,this.filteredCosmetics=e,this.updateFilteredCosmetics(),this.loading=!1})).catch((t=>{this.showError=!0,this.error=t,this.loading=!1}))},isConsumableOrChest(t){return"Chest"===t.cosmetic_type||"Consumable"===t.cosmetic_type},isUsable(t){return("buy_bp"!==t.cosmetic_name||!this.bpUpgraded)&&(!t.cosmetic_name.includes("doubledown")&&"Consumable"===t.cosmetic_type)},hideModal(t){this.$refs[`modal-${t}`][0].hide()},hideAllModals(){for(const t of Object.values(this.$refs))t[0]&&t[0].hide&&t[0].hide()},open(){this.needReload=!0},onHide(){this.needReload&&(this.needReload=!1,this.hideAllModals(),this.getPlayerCosmetics())},claim(){this.needReload=!1,this.hideAllModals(),this.getPlayerCosmetics()},equippable(t){return""!=t.equip_group},toggleFilter(t){this.filters=this.filters.map((e=>({...e,active:e.name===t}))),this.currentFilter=t,this.updateFilteredCosmetics()},updateFilteredCosmetics(){this.filteredCosmetics=c(this.cosmetics,this.currentFilter,this.activeRarityFilters,this.searchText)},equipCosmetic(t,e,s){fetch(`/api/players/${this.steamID}/cosmetics/${t.cosmetic_id}/equip?equip=${e}`,{method:"post"}).then((t=>{if(!t.ok)throw Error(t.statusText);return t})).then((t=>t.json())).then((()=>{this.getPlayerCosmetics(),this.hideModal(s)})).catch((t=>{this.error=t,this.showError=!0}))},consumeItem(t,e){fetch(`/api/players/${this.steamID}/use_item/${t.cosmetic_id}`,{method:"post",headers:{"Content-Type":"application/json"}}).then((t=>t.json())).then((t=>{t.error?(this.error=t.error,this.showError=!0):(this.success=!0,this.hideModal(e),this.$store.dispatch("REFRESH_BATTLE_PASS"),this.$store.dispatch("REFRESH_PLAYER"),this.getPlayerCosmetics())})).catch((t=>{this.error=t,this.showError=!0}))}}},$=y,w=(0,h.Z)($,i,r,!1,null,null,null),x=w.exports},3516:function(t,e,s){s.d(e,{Z:function(){return m}});var i=function(){var t=this,e=t._self._c;return"object"===typeof t.getDescription()?e("div",[e("ul",{staticClass:"text-left"},t._l(t.getDescription(),(function(s){return e("li",{key:s},[t._v(" "+t._s(s)+" ")])})),0)]):"string"===typeof t.getDescription()?e("div",[t._v(" "+t._s(t.getDescription())+" ")]):e("div",[t._v(t._s(t.getDescription()))])},r=[],a={props:{cosmetic:{}},methods:{getDescription(){return this.$i18n.t(`cosmetic_descriptions.${this.cosmetic.cosmetic_name}`)}}},c=a,o=s(1001),n=(0,o.Z)(c,i,r,!1,null,null,null),m=n.exports},182:function(t,e,s){t.exports=s.p+"media/inv_ticket.607f968b.wav"}}]);
//# sourceMappingURL=622.2fd339d3.js.map