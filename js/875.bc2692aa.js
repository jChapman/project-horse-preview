"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[875],{3516:function(t,s,e){e.d(s,{Z:function(){return m}});var c=function(){var t=this,s=t._self._c;return"object"===typeof t.getDescription()?s("div",[s("ul",{staticClass:"text-left"},t._l(t.getDescription(),(function(e){return s("li",{key:e},[t._v(" "+t._s(e)+" ")])})),0)]):"string"===typeof t.getDescription()?s("div",[t._v(" "+t._s(t.getDescription())+" ")]):s("div",[t._v(t._s(t.getDescription()))])},i=[],o={props:{cosmetic:{}},methods:{getDescription(){return this.$i18n.t(`cosmetic_descriptions.${this.cosmetic.cosmetic_name}`)}}},r=o,a=e(1001),n=(0,a.Z)(r,c,i,!1,null,null,null),m=n.exports},6875:function(t,s,e){e.r(s),e.d(s,{default:function(){return f}});var c=function(){var t=this,s=t._self._c;return s("div",[s("h1",{directives:[{name:"t",rawName:"v-t",value:"store.page_title",expression:"'store.page_title'"}],staticClass:"page-title"}),s("div",{staticClass:"container"},[t.$route.query.type?t._e():s("div",{staticClass:"row"},[s("div",{staticClass:"sale"},[t.cosmetics.length>0?s("router-link",{attrs:{to:t.getCheckoutLink("buy_bp")}},[s("img",{staticClass:"promoted",attrs:{src:"/images/cosmetics/buy_bp.png",alt:"Buy Battle Pass"}})]):t._e(),s("div",{staticClass:"overlay"},[s("h3",{directives:[{name:"t",rawName:"v-t",value:"cosmetics.buy_bp",expression:"'cosmetics.buy_bp'"}]})])],1),s("div",{staticClass:"sale"},[t.cosmetics.length>0?s("router-link",{attrs:{to:t.getCheckoutLink("plus_year_package")}},[s("img",{staticClass:"promoted",attrs:{src:"/images/cosmetics/plus_year_package.png",alt:"Buy Plus Year Package"}})]):t._e(),s("div",{staticClass:"overlay"},[s("h3",{directives:[{name:"t",rawName:"v-t",value:"cosmetics.plus_year_package",expression:"'cosmetics.plus_year_package'"}]})])],1)]),s("div",{staticClass:"row"},[s("b-alert",{staticStyle:{width:"100%"},attrs:{variant:"danger",dismissible:""},model:{value:t.showError,callback:function(s){t.showError=s},expression:"showError"}},[t._v(" "+t._s(t.error)+" ")]),s("div",{staticClass:"cosmetics"},t._l(t.shopCosmetics,(function(e){return s("div",{key:e.cosmetic_id,staticClass:"cosmetics__item"},[s("div",{staticClass:"cosmetic shop-item",on:{click:function(s){return t.$bvModal.show(`bp-modal-${e.cosmetic_id}`)}}},[s("div",[s("img",{staticClass:"preview-image",attrs:{src:`/images/cosmetics/${e.cosmetic_name}.png`,alt:e.cosmetic_name}})]),s("div",{staticClass:"cosmetic__descr"},[s("div",{staticClass:"cosmetic__name mb-1"},[t._v(" "+t._s(t.$t(`cosmetics.${e.cosmetic_name}`))+" ")]),s("div",{staticClass:"text-muted"},[t._v(" "+t._s(t.$t(`cosmetic_types.${e.cosmetic_type}`))+" ")]),s("div",{staticClass:"cosmetic__price"},[s("span",{staticClass:"cosmetic-price"},[e.cost_coins>0?[t._v(" "+t._s(e.cost_coins.toLocaleString())+" "+t._s(t.$t("common.coins"))+" ")]:[t._v("$"+t._s(e.cost_usd))]],2)])])]),s("b-modal",{ref:`bp-modal-${e.cosmetic_id}`,refInFor:!0,attrs:{id:`bp-modal-${e.cosmetic_id}`,centered:"","hide-header":"","hide-footer":""}},[s("p",{staticClass:"text-center h4"},[t._v(" "+t._s(t.$t(`cosmetics.${e.cosmetic_name}`))+" ")]),s("div",{staticClass:"text-center text-muted mb-3"},[t._v(" "+t._s(t.$t(`cosmetic_types.${e.cosmetic_type}`))+" ")]),s("p",{staticClass:"text-center"},[e.cost_coins>0?[t._v(" "+t._s(e.cost_coins)+" "+t._s(t.$t("common.coins"))+" ")]:[t._v("$"+t._s(e.cost_usd))]],2),s("div",[s("b-img-lazy",{staticClass:"preview-image",attrs:{src:t.cosmeticImageSrc(e),alt:e.cosmetic_name}})],1),s("CosmeticDescription",{staticClass:"mt-4",attrs:{cosmetic:e}}),t.loggedIn?s("div",{staticClass:"mt-4 d-flex justify-content-end"},[s("b-button",{staticClass:"mr-2",attrs:{variant:"secondary"},on:{click:function(s){return t.hideModal(e.cosmetic_id)}}},[t._v(t._s(t.$t("armory.cancel")))]),e.cost_usd>0?s("b-button",{staticClass:"mr-2",attrs:{variant:"primary",to:t.getCheckoutLink(e.cosmetic_name)}},[t._v(t._s(t.$t("store.buy")))]):s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-confirm-purchase",modifiers:{"modal-confirm-purchase":!0}}],staticClass:"mr-2",attrs:{disabled:t.coins<e.cost_coins,variant:"primary"},on:{click:function(s){t.currentCosmetic=e}}},[t._v(t._s(t.$t("store.buy")))])],1):s("div",{staticClass:"mt-4 d-flex justify-content-center"},[s("LoginButton")],1)],1)],1)})),0)],1)]),s("ConfirmPurchase",{attrs:{cosmetic:t.currentCosmetic},on:{buy:t.buyItem,cancel:t.hideModal}})],1)},i=[],o=function(){var t=this,s=t._self._c;return s("b-modal",{ref:"modal-confirm-purchase",attrs:{id:"modal-confirm-purchase",centered:"","hide-header":"","hide-footer":""}},[t._v(" Do you want to buy this item? "),s("div",{staticClass:"mt-4 d-flex justify-content-end"},[s("b-button",{staticClass:"mr-2",attrs:{variant:"secondary"},on:{click:t.cancel}},[t._v("Cancel")]),s("b-button",{staticClass:"mr-2",attrs:{variant:"primary"},on:{click:t.buy}},[t._v("Confirm")])],1)])},r=[],a={props:{cosmetic:{}},methods:{buy(){const t=`cosmetics.${this.cosmetic.cosmetic_name}`;this.$bvToast.toast(`Added ${this.$i18n.t(t)} to your armory`,{title:"Notification",toaster:"b-toaster-bottom-left",solid:!0,appendToast:!0}),this.$refs["modal-confirm-purchase"].hide(),this.$emit("buy",this.cosmetic)},cancel(){this.$refs["modal-confirm-purchase"].hide(),this.$emit("cancel",this.cosmetic.cosmetic_id)}}},n=a,m=e(1001),l=(0,m.Z)(n,o,r,!1,null,null,null),d=l.exports,u=e(3516),h=e(8828),_={components:{LoginButton:h.Z,ConfirmPurchase:d,CosmeticDescription:u.Z},data:()=>({error:"",showError:!1,success:!1,loading:!1,currentCosmetic:{},cosmetics:[],shopCosmetics:[],sortPriorities:{"Card Frame":1,Chest:2}}),computed:{loggedIn(){return this.$store.getters.loggedIn},steamID(){return this.$store.state.auth.userSteamID},coins(){return this.$store.state.auth.coins}},created(){const t=this.$route.query.type;this.loggedIn&&this.steamID&&fetch(`/api/players/${this.steamID}/cosmetics`).then((t=>t.json())).then((t=>{this.ownedCosmetics=t})).catch((t=>{this.showError=!0,this.error=t})),fetch("/api/cosmetics").then((t=>t.json())).then((s=>{this.cosmetics=s,this.shopCosmetics=s.filter((s=>{if(!t)return!0;switch(t){case"gold":return s.cosmetic_name.includes("gold_");case"chest":return s.cosmetic_name.includes("chest_");case"xp":return s.cosmetic_name.includes("_xp_");case"plus":return s.cosmetic_name.includes("plus_");case"gods":return s.cosmetic_name.includes("card_");default:return!0}})).filter((t=>t.cost_coins>0||t.cost_usd>0)).sort(((t,s)=>{const e=this.sortPriorities[t.cosmetic_type]||3,c=this.sortPriorities[s.cosmetic_type]||3;if(e!==c)return e-c;const i=t.cosmetic_name.slice(0,5),o=s.cosmetic_name.slice(0,5);return i!==o?"chest"===i?-1:"chest"===o?1:i.localeCompare(o):t.cost_usd-s.cost_usd}))})).catch((t=>{this.error=t,this.showError=!0}))},methods:{hideModal(t){this.$refs[`bp-modal-${t}`][0].hide()},getCheckoutLink(t){const s=this.cosmetics.find((s=>s.cosmetic_name===t));return s?`checkout/${s.cosmetic_id}`:"checkout"},buyItem(t){const{cosmetic_id:s,cost_coins:e}=t;this.hideModal(s),this.coins<e||(this.selected=[],this.loading=!0,fetch(`/api/players/${this.steamID}/buy_item/${s}`,{method:"post"}).then((t=>t.json())).then((t=>{this.loading=!1,document.documentElement.scrollTop=0,t.error?(this.error=t.error,this.showError=!0):(this.success=!0,this.$store.dispatch("REFRESH_COINS"))})).catch((t=>{this.error=t,this.loading=!1,this.showError=!0,document.documentElement.scrollTop=0})))},cosmeticImageSrc(t){const{cosmetic_name:s}=t;return`/images/cosmetics/${s}.png`}}},p=_,v=(0,m.Z)(p,c,i,!1,null,"22f11bfe",null),f=v.exports}}]);
//# sourceMappingURL=875.bc2692aa.js.map