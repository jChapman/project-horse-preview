"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[244],{2244:function(e,t,s){s.r(t),s.d(t,{default:function(){return P}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-layout__content"},[t("div",{staticClass:"content"},[t("h1",{staticClass:"page-title"},[e._v("Admin")]),t("div",{staticClass:"container"},[t("b-card",{attrs:{"no-body":""}},[t("b-tabs",{attrs:{pills:"",card:""}},[t("b-tab",{attrs:{"title-link-class":"tab",title:"Players",active:""}},[t("PlayersAdmin")],1),t("b-tab",{attrs:{"title-link-class":"tab",title:"Gods",lazy:""}},[t("GodsAdmin")],1),t("b-tab",{attrs:{"title-link-class":"tab",title:"Codes",lazy:""}},[t("RedemptionCodes")],1)],1)],1)],1)])])},a=[],o=function(){var e=this,t=e._self._c;return t("div",[""!=e.error?t("b-alert",{attrs:{show:"",variant:"danger",dismissible:""}},[e._v(" "+e._s(e.error)+" ")]):e._e(),""!=e.success?t("b-alert",{attrs:{show:"",variant:"success",dismissible:""}},[e._v("Transaction Success!")]):e._e(),e.loading?t("div",{staticClass:"d-flex justify-content-center mb-3"},[t("b-spinner",{attrs:{label:"Loading..."}})],1):e._e(),t("div",[e._v("Your SteamID is: "+e._s(e.yourSteamID))]),t("b-form-input",{attrs:{placeholder:"Enter Steam ID..."},model:{value:e.steamID,callback:function(t){e.steamID=t},expression:"steamID"}}),t("b-button",{staticClass:"mt-3",attrs:{type:"submit",variant:"primary"},on:{click:function(t){return e.getPlayerData(e.steamID)}}},[e._v("Find Player")]),e.playerData.username?[t("b-card",{staticClass:"mt-3",attrs:{title:e.playerData.username,"sub-title":e.playerData.steam_id}},[t("b-list-group",{attrs:{flush:""}},[t("b-list-group-item",[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}],attrs:{variant:"success",size:"sm"}},[e._v("+")]),e._v(" Gold "),t("span",{staticClass:"text-muted"},[e._v(e._s(e.playerData.coins))]),t("b-modal",{attrs:{id:"modal-1",title:"Give Coins"},on:{ok:e.giveCoins}},[t("b-form-input",{attrs:{type:"number"},model:{value:e.coins,callback:function(t){e.coins=t},expression:"coins"}})],1)],1),t("b-list-group-item",[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.give-bp",modifiers:{"give-bp":!0}}],attrs:{variant:"success",size:"sm"}},[e._v("+")]),e._v(" Battle Pass XP "),t("span",{staticClass:"text-muted"},[e._v(e._s(e.battlePass.total_xp))]),t("b-modal",{attrs:{id:"give-bp",title:"Give Battle Pass XP"},on:{ok:e.giveBP}},[t("b-form-input",{attrs:{type:"number"},model:{value:e.bp,callback:function(t){e.bp=t},expression:"bp"}})],1)],1),t("b-list-group-item",[e._v(" Battle Pass Level "),t("span",{staticClass:"text-muted"},[e._v(e._s(e.battlePass.bp_level))])]),t("b-list-group-item",[e._v(" Type "),t("span",{staticClass:"text-muted"},[e._v(e._s(e.playerData.user_type))])]),t("b-list-group-item",[e._v(" Has Plus "),t("span",{staticClass:"text-muted"},[e._v(e._s(e.playerData.has_plus?"Yes":"No"))])]),t("b-list-group-item",[e._v(" MMR "),t("span",{staticClass:"text-muted"},[e._v(e._s(e.playerData.mmr))])]),t("b-list-group-item",[e._v(" Ladder MMR "),t("span",{staticClass:"text-muted"},[e._v(e._s(e.playerData.ladder_mmr))])])],1)],1),t("b-card",{attrs:{title:"Events"}},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse-2",modifiers:{"collapse-2":!0}}],attrs:{variant:"primary"}},[e._v("Events")]),t("b-collapse",{staticClass:"mt-2 mb-2",attrs:{id:"collapse-2"}},[t("b-card",e._l(Object.entries(e.transactions),(function([s,i]){return t("b-list-group-item",{key:s},[t("div",{staticClass:"d-flex justify-content-between align-items-center"},[t("div",[t("div",[e._v(e._s(i.log_event))]),t("div",{staticClass:"text-muted"},[e._v(" "+e._s(new Date(i.log_time).toLocaleString())+" ")])]),t("div",["paypal"==i.log_event?[e._v("Item ID: "+e._s(i.log_data.itemID))]:[t("pre",[e._v(e._s(i.log_data))])]],2)])])})),1)],1)],1),t("b-card",{attrs:{title:"Cosmetics"}},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse-1",modifiers:{"collapse-1":!0}}],attrs:{variant:"primary"}},[e._v("Give Items")]),t("b-collapse",{staticClass:"mt-2 mb-2",attrs:{id:"collapse-1"}},[t("b-form-input",{attrs:{placeholder:"Search Items..."},model:{value:e.cosmeticsFilter,callback:function(t){e.cosmeticsFilter=t},expression:"cosmeticsFilter"}}),t("b-card",e._l(e.filteredOptions,(function(s){return t("div",{key:s.value.cosmetic_id,staticClass:"d-flex align-items-center my-1"},[t("b-button",{staticClass:"mr-3",attrs:{disabled:e.loading,variant:"success"},on:{click:function(t){return e.addItem(s.value)}}},[e._v("Add")]),t("div",[e._v(e._s(s.text))])],1)})),0)],1),t("h4",{staticClass:"card-title"},[e._v("Inventory")]),e._l(e.cosmetics,(function(s,i){return t("div",{key:s.cosmetic_id+s.created+s.equipped+i,staticClass:"d-flex align-items-center my-1"},[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.delete-item",modifiers:{"delete-item":!0}}],staticClass:"mr-3",attrs:{variant:"danger",size:"sm"},on:{click:function(t){return e.setItem(s)}}},[e._v("x")]),e._v(" "+e._s(e.$t(`cosmetics.${s.cosmetic_name}`))+" "),t("span",{staticClass:"text-muted mx-1"},[e._v(e._s(s.cosmetic_name))]),s.equipped?t("span",[e._v(": Equipped")]):e._e()],1)}))],2),t("b-modal",{attrs:{id:"delete-item",title:"Delete Item"},on:{ok:e.deleteItem}},[t("p",[e._v("Delete this item from this player's inventory?")]),t("pre",{staticStyle:{color:"white"}},[e._v(e._s(e.currentItem))])])]:e._e()],2)},n=[],r=(s(1703),{data:()=>({error:"",steamID:"",cosmeticsFilter:"",playerData:{},cosmetics:[],battlePass:{},options:[],filteredOptions:[],selected:[],loading:!1,success:"",coins:null,bp:null,currentItem:{},transactions:[],showTransactions:!1}),created(){fetch("/api/cosmetics").then((e=>e.json())).then((e=>{this.options=e.map((e=>({value:e,text:e.cosmetic_name}))),this.filteredOptions=this.options})).catch((e=>this.error=e))},computed:{yourSteamID(){return this.$store.state.auth.userSteamID}},watch:{cosmeticsFilter:function(){this.cosmeticsFilter?this.filteredOptions=this.options.filter((e=>e.text.toLowerCase().includes(this.cosmeticsFilter.toLowerCase()))):this.filteredOptions=this.options}},methods:{setItem(e){this.currentItem=e},getTransactions(e){fetch(`/api/logs/players/${e}`).then((e=>e.json())).then((e=>this.transactions=e))},getPlayerData(e){this.transactions=[],fetch(`/api/players/${e}`).then((e=>e.json())).then((e=>{this.playerData=e,null==this.playerData.username&&(this.error="No player with this SteamID found")})).catch((e=>this.error=e)),this.getTransactions(e),fetch(`/api/players/${e}/cosmetics`).then((e=>e.json())).then((e=>{this.cosmetics=e})).catch((e=>this.error=e)),fetch(`/api/players/${e}/battle_pass`).then((e=>e.json())).then((e=>{this.battlePass=e})).catch((e=>this.error=e))},deleteItem(){const e={itemTransaction:{items:{[this.currentItem.cosmetic_id]:-1}}};this.currentItem={},this.doTransaction(e)},addItem(e){const t={itemTransaction:{items:{[e.cosmetic_id]:1}}};this.doTransaction(t)},giveCoins(){this.doTransaction({itemTransaction:{coins:this.coins}})},giveBP(){this.doTransaction({itemTransaction:{battlePass:{bonusExp:this.bp}}})},doTransaction(e){this.loading=!0,fetch(`/api/players/${this.steamID}/transaction`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>{if(!e.ok)throw Error("Transaction failed");return e})).then((e=>e.json())).then((e=>{this.loading=!1,this.success=e.message,this.getPlayerData(this.steamID),this.steamID===this.yourSteamID&&this.$store.dispatch("REFRESH_COINS"),this.$store.dispatch("REFRESH_BATTLE_PASS")})).catch((e=>{this.error,this.loading=!1}))}}}),c=r,l=s(1001),d=(0,l.Z)(c,o,n,!1,null,"0e9c65b6",null),m=d.exports,u=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"gods-container"},e._l(e.gods,(function(s){return t("div",{key:s.god_name,staticClass:"text-center m-3",staticStyle:{position:"relative"}},[s.god_enabled?e._e():t("div",{staticClass:"overlay"}),t("GodImage",{attrs:{god:s.god_name,height:100}}),t("div",{class:{"my-1":!0,"text-muted":!s.god_enabled}},[e._v(" "+e._s(e.$t(`gods.${s.god_name}`))+" ")]),s.error?t("div",{staticClass:"text-danger"},[e._v("Error")]):e._e(),t("div",[t("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:function(t){return e.toggleDisabled(s)}}},[s.god_enabled?[e._v("Enabled")]:e._e(),s.god_enabled?e._e():[e._v("Disabled")],s.loading?t("b-spinner",{attrs:{small:"",label:e.Loading}}):e._e()],2)],1),t("div",[t("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:function(t){return e.toggleIsFree(s)}}},[s.free?[e._v("Free")]:e._e(),s.free?e._e():[e._v("Paid")],s.loading?t("b-spinner",{attrs:{small:"",label:e.Loading}}):e._e()],2)],1),t("div",[t("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:function(t){return e.togglePlusExclusive(s)}}},[s.plus_exclusive?[e._v("Plus")]:e._e(),s.plus_exclusive?e._e():[e._v("Not Plus")],s.loading?t("b-spinner",{attrs:{small:"",label:e.Loading}}):e._e()],2)],1)],1)})),0)])},p=[],h=s(2371),v={components:{GodImage:h.Z},data:()=>({loading:!0,gods:[]}),created(){fetch("/api/gods").then((e=>e.json())).then((e=>{this.gods=e,this.loading=!1}))},methods:{toggleDisabled(e){e.loading=!0;const{god_name:t,god_enabled:s}=e;fetch(`/api/gods/${t}/set_enabled?enabled=${!s}`,{method:"POST"}).then((e=>e.json())).then((t=>{e.god_enabled=t.god_enabled,e.loading=!1})).catch((()=>{e.error=!0,e.loading=!1}))},toggleIsFree(e){e.loading=!0;const{god_name:t,free:s}=e;fetch(`/api/gods/${t}/set_is_free?isFree=${!s}`,{method:"POST"}).then((e=>e.json())).then((t=>{e.free=t.free,e.loading=!1})).catch((()=>{e.error=!0,e.loading=!1}))},togglePlusExclusive(e){e.loading=!0;const{god_name:t,plus_exclusive:s}=e;fetch(`/api/gods/${t}/set_plus_exclusive?plusExclusive=${!s}`,{method:"POST"}).then((e=>e.json())).then((t=>{e.plus_exclusive=t.plus_exclusive,e.loading=!1})).catch((()=>{e.error=!0,e.loading=!1}))}}},_=v,b=(0,l.Z)(_,u,p,!1,null,"611c0eb8",null),g=b.exports,C=function(){var e=this,t=e._self._c;return t("div",[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.create-code",modifiers:{"create-code":!0}}],attrs:{variant:"success",size:"sm"}},[e._v("Create a New Code")]),t("b-modal",{attrs:{id:"create-code-error",title:"Error","ok-label":e.$t("common.close")},on:{ok:function(t){e.error=""}}},[t("p",[e._v(e._s(e.error))])]),t("b-modal",{attrs:{id:"create-code",title:"Create Redemption Code","ok-disabled":!(e.newCode.code&&(e.newCode.cosmetics&&e.newCode.cosmetics.length>0||e.newCode.coins))},on:{ok:e.createCode,cancel:e.clearNewCode}},[t("b-form-group",{attrs:{id:"input-group-2",label:"Code Name","label-for":"input-2"}},[t("b-form-input",{attrs:{type:"text",placeholder:"Enter the code"},model:{value:e.newCode.code,callback:function(t){e.$set(e.newCode,"code",t)},expression:"newCode.code"}})],1),t("b-form-group",{attrs:{id:"input-group-2",label:"Gold","label-for":"input-2"}},[t("b-form-input",{staticClass:"mt-3",attrs:{type:"number",placeholder:"Gold"},model:{value:e.newCode.coins,callback:function(t){e.$set(e.newCode,"coins",t)},expression:"newCode.coins"}})],1),t("b-form-group",{attrs:{id:"input-group-2",label:"Limit (optional, default infinite)","label-for":"input-2"}},[t("b-form-input",{staticClass:"mt-3",attrs:{type:"number",placeholder:"Limit"},model:{value:e.newCode.redemption_limit,callback:function(t){e.$set(e.newCode,"redemption_limit",t)},expression:"newCode.redemption_limit"}})],1),t("hr"),t("b-form-group",{attrs:{id:"input-group-2",label:"Cosmetics","label-for":"input-2"}},[t("b-form-input",{staticClass:"mt-3",attrs:{type:"text",placeholder:"Search cosmetics"},model:{value:e.cosmeticsFilter,callback:function(t){e.cosmeticsFilter=t},expression:"cosmeticsFilter"}})],1),t("b-form-select",{staticClass:"mt-3",attrs:{options:e.filteredCosmetics,"select-size":7},model:{value:e.newCode.cosmetic,callback:function(t){e.$set(e.newCode,"cosmetic",t)},expression:"newCode.cosmetic"}}),t("b-button",{staticClass:"mt-2",attrs:{variant:"success",size:"sm",disabled:!e.newCode.cosmetic},on:{click:e.addCosmetic}},[e._v(" Add Cosmetic ")]),t("div",e._l(e.newCode.cosmetics,(function(s){return t("div",{key:s.cosmetic_id,staticClass:"d-flex align-items-center my-1"},[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.delete-cosmetic",modifiers:{"delete-cosmetic":!0}}],staticClass:"mr-3",attrs:{variant:"danger",size:"sm"},on:{click:function(t){return e.removeCosmetic(s)}}},[e._v("x")]),e._v(" "+e._s(e.$t(`cosmetics.${s.cosmetic_name}`))+" "),t("span",{staticClass:"text-muted mx-1"},[e._v(e._s(s.cosmetic_name))])],1)})),0)],1),t("div",{staticClass:"d-flex flex-wrap p-3"},e._l(e.codes,(function(s){return t("div",{key:s.code,staticClass:"p-2 text-center"},[t("div",{staticClass:"text-center",staticStyle:{height:"90px","overflow-y":"auto"}},[t("div",[e._v(e._s(s.code))]),t("div",{staticClass:"text-muted"},[e._v(" ("+e._s(s.num_redeemed.toLocaleString())+" / "+e._s(null!=s.redemption_limit?s.redemption_limit.toLocaleString():"∞")+") ")]),s.coins?t("div",[t("img",{staticClass:"coins-image",staticStyle:{width:"20px",height:"20px"},attrs:{src:"/images/coin1.png",alt:"coins"}}),e._v(" "+e._s(s.coins)+" ")]):e._e(),e._l(s.rewards,(function(s){return t("div",{key:s.cosmetic_id,staticClass:"text-muted"},[e._v(" "+e._s(s.cosmetic_name)+" ")])}))],2),t("div",{staticClass:"text-center mt-2",staticStyle:{width:"200px"}},[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.view-redemptions",modifiers:{"view-redemptions":!0}}],staticClass:"w-100 mt-1",attrs:{variant:"primary",size:"sm"},on:{click:function(t){return e.loadPlayers(s)}}},[e._v("Redemptions")]),s.active?t("b-button",{staticClass:"w-100 mt-1",attrs:{size:"sm"},on:{click:function(t){return e.toggleEnabled(s)}}},[e._v("Disable")]):e._e(),s.active?e._e():t("b-button",{staticClass:"w-100 mt-1",attrs:{size:"sm"},on:{click:function(t){return e.toggleEnabled(s)}}},[e._v("Enable")]),t("b-button",{staticClass:"w-100 mt-1",attrs:{size:"sm",variant:"danger"},on:{click:function(t){return e.tryDeleteCode(s)}}},[e._v(" Delete")])],1),t("b-modal",{attrs:{id:`players-${s.code}`,title:"Redemptions"}},[s.loading?t("div",[e._v("Loading...")]):e._e(),s.players?t("p",[e._v(" Total Redemptions: "+e._s(s.players.length)+" ")]):e._e(),t("div",{staticStyle:{"max-height":"600px","overflow-y":"auto"}},e._l(s.players,(function(s){return t("div",{key:s.steam_id},[t("div",{staticClass:"d-flex align-items-center my-1"},[t("div",[e._v(e._s(s.username))]),t("div",{staticClass:"text-muted mx-1"},[e._v(" "+e._s(s.date_claimed.toLocaleString())+" ")])])])})),0)])],1)})),0)],1)},f=[],y=(s(7658),{data:()=>({codes:[],cosmetics:[],filteredCosmetics:[],loading:!0,newCode:{},cosmeticsFilter:"",error:""}),created(){fetch("/api/cosmetics").then((e=>e.json())).then((e=>{this.cosmetics=e.map((e=>({value:e,text:e.cosmetic_name}))),this.filteredCosmetics=this.cosmetics})),this.getCodes()},watch:{cosmeticsFilter(e){this.filteredCosmetics=e?this.cosmetics.filter((t=>t.text.toLowerCase().includes(e.toLowerCase()))):this.cosmetics}},methods:{addCosmetic(){this.newCode.cosmetics||(this.newCode.cosmetics=[]),this.newCode.cosmetics.push(this.newCode.cosmetic),this.newCode.cosmetic=null},removeCosmetic(e){this.newCode.cosmetics=this.newCode.cosmetics.filter((t=>t.cosmetic_id!==e.cosmetic_id)),this.$forceUpdate()},clearNewCode(){this.newCode={}},getCodes(){fetch("/api/redemption_codes").then((e=>e.json())).then((e=>{this.codes=e,this.loading=!1}))},createCode(e){e.preventDefault(),this.newCode.cosmetics||(this.newCode.cosmetics=[]);const t=this.newCode.cosmetics.map((e=>e.cosmetic_id));fetch(`/api/redemption_codes/${this.newCode.code}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cosmeticIDs:t,coins:this.newCode.coins,redemptionLimit:this.newCode.redemption_limit})}).then((e=>e.json())).then((e=>{e.error?(this.error=e.error,this.$bvModal.show("create-code-error")):(this.getCodes(),this.clearNewCode(),this.$bvModal.hide("create-code"))}))},loadPlayers(e){this.$bvModal.show(`players-${e.code}`),e.loadingPlayers=!0,fetch(`/api/redemption_codes/${e.code}/players`).then((e=>e.json())).then((t=>{e.players=t,e.loadingPlayers=!1,this.$forceUpdate()}))},toggleEnabled(e){fetch(`/api/redemption_codes/${e.code}/active`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({active:!e.active})}).then((e=>e.json())).then((()=>{this.loading=!0,this.getCodes()}))},tryDeleteCode(e){this.$bvModal.msgBoxConfirm(`Are you sure you want to delete code ${e.code}?`,{title:"Confirm Delete",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"DELETE",cancelTitle:"Cancel",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((t=>{t&&this.deleteCode(e)}))},deleteCode(e){fetch(`/api/redemption_codes/${e.code}`,{method:"DELETE"}).then((()=>{this.loading=!0,this.getCodes()}))}}}),w=y,x=(0,l.Z)(w,C,f,!1,null,"3d330871",null),k=x.exports,D={components:{PlayersAdmin:m,GodsAdmin:g,RedemptionCodes:k}},I=D,$=(0,l.Z)(I,i,a,!1,null,"07abb146",null),P=$.exports}}]);
//# sourceMappingURL=244.1ced7268.js.map